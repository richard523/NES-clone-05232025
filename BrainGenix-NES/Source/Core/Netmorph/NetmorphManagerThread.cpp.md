## Inputs

The primary inputs for the functionality in this file are provided to the `ExecuteNetmorphOperation` function:
*   `_Logger` (BG::Common::Logger::LoggingSystem\*): A pointer to the logging system.
*   `_Params` (NetmorphParameters\*): A pointer to a `NetmorphParameters` struct. This struct contains:
    *   `ModelContent`: A string, typically the content of a Netmorph model file, used as input for the Netmorph simulation.
    *   `OutputDirectory`: A string specifying the directory for Netmorph output.
    *   `Sim`: A pointer to the NES `Simulation` object that will be populated if `BuildFromNetmorphNetwork` is called.

The `BuildFromNetmorphNetwork` function internally uses:
*   `_Params.Result.net`: The Netmorph network object generated by the `NetmorphRun`.
*   Hardcoded parameters within `DynamicPars` and `PSPTiming` structs for default neuron and synapse properties.

## Outputs

The `ExecuteNetmorphOperation` function modifies the `_Params` struct it receives:
*   `_Params->Result`: Populated with the output from the Netmorph simulation, including a status and the generated Netmorph network object (`net`).
*   `_Params->Progress_percent`: Updated to reflect the progress of the Netmorph simulation.
*   `_Params->State`: Set to `Netmorph_DONE` upon completion.

If the Netmorph simulation is successful, the `BuildFromNetmorphNetwork` function is called, which has the following significant side effects:
*   The NES `Simulation` object (accessed via `_Params->Sim`) is populated with:
    *   Neurons (`CoreStructs::SCNeuronStruct`)
    *   Neurite segments (geometries like `Geometries::Cylinder` and compartments like `Compartments::BS`)
    *   Synapses (geometries like `Geometries::Box` and receptor compartments like `Connections::Receptor`)
    *   Brain regions (`BrainRegions::BrainRegion`) and associated neural circuits.
*   Logs messages detailing the success or failure of various build steps.

The `ExecuteNetmorphOperation` function returns an `int` (0), likely indicating successful completion of the function call.

## Description

This module (`NetmorphManagerThread.cpp` and `NetmorphManagerThread.h`) is responsible for integrating the external Netmorph library to generate neural network structures and then translating these structures into the BrainGenix-NES simulation environment. The main function, `ExecuteNetmorphOperation`, orchestrates running a Netmorph simulation based on provided parameters. If the Netmorph simulation succeeds, the `BuildFromNetmorphNetwork` function and its helper classes meticulously convert the Netmorph-generated neurons, neurites, synapses, and regions into their corresponding representations within the NES simulation. This allows BrainGenix-NES to utilize procedurally generated networks from Netmorph.

## ASCII Diagram

```
+---------------------------------+
| ExecuteNetmorphOperation        |
|  (_Logger*, _Params*)           |
+---------------------------------+
| 1. Setup Nm2NESLogging          |
| 2. Call NetmorphRun             |
|    (updates _Params->Result,    |
|     _Params->Progress_percent)  |
| 3. If Success: Call             |
|    BuildFromNetmorphNetwork(*_Params)|
| 4. _Params->Result.postop()     |
| 5. _Params->State = DONE        |
| Returns 0                       |
+---------------------------------+
          | (If NetmorphRun successful)
          v
+---------------------------------+
| BuildFromNetmorphNetwork        |
|  (_Params: &NetmorphParameters) |
+---------------------------------+
| - Uses _Params.Result.net       |
| - Uses _Params.Sim              |
| - NeuronBuild                   |
|   - NeuriteBuild (Axon/Dendrite)|
| - SynapseBuild                  |
| - RegionBuild                   |
| Modifies _Params.Sim by adding  |
| neurons, synapses, regions.     |
| Returns bool (status)           |
+---------------------------------+
          |
          | Uses Helper Classes (Internal Visitors)
          |
+---------------------------------+
| Nm2NESLogging                   | (Adapts logging)
+---------------------------------+
| NeuriteBuild (fibre_tree_op)    | (Builds NES neurites)
+---------------------------------+
| SynapseBuild (synapse_tree_op)  | (Builds NES synapses)
+---------------------------------+
| NeuronBuild (neuron_list_op)    | (Builds NES neurons)
+---------------------------------+
| RegionBuild (region_list_op)    | (Builds NES regions)
+---------------------------------+
```
